# Integração do Fabric
<img width="804" height="434" alt="image" src="https://github.com/user-attachments/assets/7f4e8cf3-5b8f-479f-8c9c-f25b799c02e7" />

O registro de logs e respostas opera de modo que:

1. Dispositivos registrados enviam dados de logs para o FortiAnalyzer.
2. FortiAnalyzer agrega e armazena os logs de maneira que faz com que seja fácil pesquisar e gerar reportes.
3. Administradores podem acessar FortiAnalyzer usando a GUI para manualmente visulizar os logs ou gerar reportes para analisar os dados. Eles podem também usar a CLI para tarefas administrativas.

FortiAnalyzer pode ser facilmente integrado na rede, mesmo em múltiplos provedores. Uma topologia típica pode incluir diversos filiais e uma sede. Cada firewal local é adicionado ao FortiAnalyzer, permitindo que o administrador visualize logs e gere reportes para toda a rede a partir de uma única interface. 

# Logs do Security Fabric

<img width="820" height="466" alt="image" src="https://github.com/user-attachments/assets/36e097d2-0665-40da-843e-7aa8ad8f650c" />

FortiAnalyzer suporta o Security Fabric armazenando e analisando os logs dos dispositivos dentro do grupo do Security Fabric como se eles se originassem de um único dispositivo. Ele correlaciona os registros de tráfego com os registros correspondentes do gerenciamento unificado de ameaças (UTM), permitindo gerar relatórios sobre sessões e largura de banda juntamente com seus eventos UTM.

Tráfego de logs para sessões de logins é sempre realizado pelo primeiro Fortigate que lida com Security Fabric. Dispositivos Fortigate sabem o mac dos seus peers upstream e downstream. Se o Fortigate recebe pacotes de um endereço MAC que pertence a outro Fortigate no Security Fabric, isso não gera um novo tráfego de logs para cada sessão. Essa abordagem ajuda a prevenir logs repetidos nas mesmas sessões por múltiplos dispositivos fortigate. 

Uma exceção para esse comportamento é que se o upstream do dispositivo Fortigate use NAT, então outro log é gerado. O log adicional é preciso para registrar os detalhes do NAT, como portas traduzidas e endereços. 

Quando configurados, os dispositivos upstream realizam o registro de logs do UTM, enquanto o FortiAnalyzer executa automaticamente a correlação dos logs de UTM e de tráfego para o Security Fabric. Esse processo garante um registro claro e preciso de quaisquer eventos de UTM que possam ocorrer, sem exigir configurações adicionais. 

Perceba que cada Fortigate no log do Security Fabric registra o tráfego para o FortiAnalyzer independemente do dispositivo raiz ou de outros dispositivos de borda. Se o Fortigate raiz estiver inativo, o registro de dados dos dispositivos Fortigate de borda para o FortiAnalyzer continua a operar normalmente. 

Em síntese, a integração entre o FortiAnalyzer e o Security Fabric garante uma estrutura de monitoramento altamente eficiente, centralizada e livre de redundâncias. Ao unificar e correlacionar logs de tráfego e eventos UTM como se todos os registros viessem de um único ponto, o FortiAnalyzer proporciona análises mais completas e precisas. O mecanismo inteligente de detecção entre os FortiGates evita duplicações de logs ao identificar sessões já registradas, exceto em cenários específicos envolvendo NAT, onde informações adicionais são indispensáveis. Além disso, a continuidade do envio de logs pelos dispositivos, mesmo na ausência do FortiGate raiz, reforça a resiliência do ambiente. Dessa forma, o Security Fabric, aliado ao FortiAnalyzer, oferece uma visão consistente, detalhada e confiável de toda a infraestrutura de segurança.


